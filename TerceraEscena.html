<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Escena 3: Avión Fuera</title>
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/n5ro/aframe-physics-system@v4.0.1/dist/aframe-physics-system.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v7.2.0/dist/aframe-extras.min.js"></script>

    <script>
        // Componente para la Interacción del motor (Audio y Animación)
        AFRAME.registerComponent('motor-starter', {
            init: function() {
                const el = this.el;
                
                el.addEventListener('click', () => {
                    console.log("Clic detectado en el avión. Reproduciendo audio y animando.");
                    
                    // Activación del sonido (el componente 'sound' lo maneja automáticamente)

                    // Animación de vibración (simula que el motor arranca)
                    el.setAttribute('animation__vibrate', {
                        property: 'position',
                        to: `${el.getAttribute('position').x} -3.5 ${el.getAttribute('position').z}`,
                        from: `${el.getAttribute('position').x} -3.4 ${el.getAttribute('position').z}`,
                        dur: 100,
                        easing: 'linear',
                        loop: 4,
                        dir: 'alternate'
                    });
                });
            }
        });
    </script>
</head>

<body>
<a-scene physics="gravity: -9.8; debug: false">

    <a-assets>
        <img id="TechoHangar" src="./assets/texturas/TechoAngar.jpg">
        <audio id="motorAudio" src="./assets/Sonidos/SonidoAvion.mp3" preload="auto"></audio> 
        <img id="SueloAsfalto" src="./assets/texturas/SueloAsfalto.jpg">
        <img id="ParedHangar" src="./assets/texturas/ParedHangar.jpg">
        <a-asset-item id="avionModelo" src="./assets/Modelos3D/Avion/scene.gltf"></a-asset-item>
    </a-assets>

        <a-plane 
    position="0 4 0" 
    rotation="90 0 0" 
    width="15" 
    height="15" 
    material="src: #TechoHangar; repeat: 5 5" 
    static-body></a-plane>

    <a-plane
        position="0 0 0"
        rotation="-90 0 0"
        width="100"
        height="100"
        material="src: #SueloAsfalto; repeat: 20 20"
        static-body                       
    ></a-plane>

    <a-box
        position="0 1.5 -7.4"
        width="15"
        height="5"
        depth="0.2"
        material="src: #ParedHangar"
        static-body
    ></a-box>
    <a-box
        position="-7.5 1.5 0"
        rotation=" 0 90 0"
        width="15"
        height="5"
        depth="0.2"
        material="src: #ParedHangar"
        static-body
    ></a-box>
    <a-box
        position="7.5 1.5 0"
        rotation=" 0 90 0"
        width="15"
        height="5"
        depth="0.2"
        material="src: #ParedHangar"
        static-body
    ></a-box>
    
    <a-sky color="Lightblue"></a-sky>

    <a-entity 
        position="0 -3.5 45" 
        scale="0.5 0.5 0.5"
        gltf-model="#avionModelo"
        motor-starter static-body="shape: box" sound="src: #motorAudio; on: click; volume: 2" class="clickable"></a-entity>
    

    <a-entity 
        id="rig" 
        movement-controls="speed: 0.3" 
        position="0 1 10"                 kinematic-body
    >
        <a-entity camera look-controls position="0 0.6 0" 
            raycaster="objects: .clickable" 
            cursor="rayOrigin: mouse">
        </a-entity>
    </a-entity>

    <a-light type="directional" color="#FFFFFF" intensity="1.2" position="10 20 10" shadow="cast: true"></a-light>
    <a-light type="ambient" color="#AAAAAA" intensity="0.5"></a-light>
    
</a-scene>
</body>
</html>






</a-scene>
</body>
</html>